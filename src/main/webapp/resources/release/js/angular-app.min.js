/*! spring-angularjs 27-09-2015 */
"use strict";var AngularApp=angular.module("AngularApp",["ngRoute","ngAnimate","angular-loading-bar","angularModalService","ui-notification","ngMessages"]);AngularApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"/home",controller:"indexController"}),a.when("/users/show",{templateUrl:"users/view/show",controller:"userController"}),a.when("/users/management",{templateUrl:"users/view/management",controller:"userController"}),a.when("/404",{templateUrl:"/404",controller:"indexController"}),a.otherwise({redirectTo:"/404"})}]),AngularApp.controller("indexController",["$scope",function(a){}]),AngularApp.controller("modalController",["$scope","close","modalService",function(a,b,c){a.modalOptions=c.getOptions(),a.close=function(a){b(a,500)}}]),AngularApp.controller("userController",["$scope","$filter","appFactory",function(a,b,c){var d=c.getUserService(),e=c.getModalService(),f=c.getErrorService(),g=c.getNotificationService();a.user={},a.searchField={},a.userForm={},a.searchForm={},a.searchableState=!1,a.editableState=!1,a.modal={},a.getUsersList=function(){a.resetErrors(),h(!1),a.usersList=[],d.fetchUserList().then(function(b){a.usersList=b})},a.addNewUser=function(b){a.resetErrors(),d.saveUser(b).then(function(){a.getUsersList(),g.success(n("User was added successfully."))})["finally"](function(){a.resetUserForm()})},a.updateUser=function(b){a.resetErrors(),d.saveUser(b).then(function(){i(!1);var c,d=a.usersList;for(c=0;c<d.length;c++)if(d[c].id===b.id){d[c]=angular.copy(b);break}g.success(n("User was updated successfully."))})["finally"](function(){a.resetUserForm()})},a.searchUsers=function(b){a.resetErrors(),h(!0),a.usersList=[],d.searchUsers(b).then(function(b){a.usersList=b})},a.deleteUserById=function(c){a.resetErrors(),a.resetUserForm(),d.deleteById(c).then(function(){var d=b("filter")(a.usersList,{id:c})[0],e=a.usersList.indexOf(d);a.usersList.splice(e,1),g.success(n("User was removed successfully."))})},a.deleteAllUsers=function(){a.resetErrors(),a.resetUserForm(),d.deleteAll().then(function(){a.usersList=[],g.success(n("All users was removed successfully."))})},a.resetSearchForm=function(){a.searchableState&&a.getUsersList(),h(!1),a.searchField.criteria="",a.searchForm.$setPristine()};var h=function(b){a.searchableState=b};a.editUser=function(b){a.resetErrors(),a.user=angular.copy(b),i(!0)},a.resetUserForm=function(){i(!1),a.userForm.$setPristine(),a.userForm.$setUntouched(),a.user={}},a.getUsersListLoadedStatus=function(){return d.getUsersListLoadedStatus()},a.getLoadingStatus=function(){return d.getLoadingStatus()},a.getSavingStatus=function(){return d.getSavingStatus()},a.getDeletionStatus=function(){return d.getDeletionStatus()};var i=function(b){a.editableState=b};a.error=function(){return f.isError()},a.errorList=function(){return f.getErrors()},a.resetErrors=function(){f.resetErrors()},a.modal.showConfirm=function(a,b){var c=k(a);e.show(c).then(function(c){c.element.modal(),c.close.then(function(c){"cancel"!==c&&l(a,b)})})};var j={DELETE_ALL:"deleteAll",DELETE_BY_ID:"deleteById"},k=function(a){var b={bodyText:"Delete all users?"},c={bodyText:"Delete this user?"},d={};switch(a){case j.DELETE_ALL:d=b;break;case j.DELETE_BY_ID:d=c}return d},l=function(b,c){switch(b){case j.DELETE_ALL:a.deleteAllUsers();break;case j.DELETE_BY_ID:"undefined"!=typeof c&&a.deleteUserById(c)}},m={delay:4e3,positionY:"top",positionX:"center"},n=function(a){var b='<i class="fa fa-fw fa-check-circle"></i>';return m.message=b+a,m};a.getUsersList()}]),AngularApp.directive("customDomDirective",function(){return{restrict:"A",link:function(){JqueryCustom.loadScripts()}}});var JqueryCustom={};JqueryCustom.misc=function(){$(".container-fluid").fadeIn(200)},JqueryCustom.loadScripts=function(){JqueryCustom.misc()},AngularApp.factory("appFactory",["modalService","userService","errorService","Notification",function(a,b,c,d){return{getUserService:function(){return b},getModalService:function(){return a},getErrorService:function(){return c},getNotificationService:function(){return d}}}]),AngularApp.service("errorService",function(){var a={title:"",messages:null},b=!1;this.setErrors=function(c,d){b=!0,a.title=c,a.messages=d},this.resetErrors=function(){b=!1},this.getErrors=function(){return a},this.isError=function(){return b}}),AngularApp.service("modalService",["ModalService",function(a){var b={controller:"modalController",templateUrl:"users/view/modal",closeButtonText:"Cancel",actionButtonText:"Delete",headerText:"Confirmation",bodyText:"Perform this action?"};this.show=function(c){return"undefined"!=typeof c&&angular.extend(b,c),a.showModal(b)},this.getOptions=function(){return b}}]),AngularApp.service("userService",["$http","$q","errorService",function(a,b,c){var d=c,e=null,f="users/service/getList.json",g="users/service/save",h="users/service/search/",i="users/service/delete/",j="users/service/deleteAll",k=!1,l=!1,m=!1,n=!1;this.fetchUserList=function(){return q(!0),p(!1),e=b.defer(),a.get(f).then(function(a){e.resolve(a.data),q(!1),p(!0)},function(a){e.reject(a),d.setErrors("Could not load users list.",a.data.errors),q(!1),p(!1)}),e.promise},this.saveUser=function(c){return r(!0),c=o(c),e=b.defer(),a.post(g,c).then(function(a){e.resolve(a.data),r(!1)},function(a){e.reject(a),d.setErrors("Could not save user.",a.data.errors),r(!1)}),e.promise},this.searchUsers=function(c){return q(!0),p(!1),e=b.defer(),a.get(h+c).then(function(a){e.resolve(a.data),q(!1),p(!0)},function(a){e.reject(a),d.setErrors("Could not find user with given criteria",a.data.errors),q(!1),p(!1)}),e.promise},this.deleteById=function(c){return s(!0),e=b.defer(),a["delete"](i+c).then(function(a){e.resolve(a.data),s(!1)},function(a){e.reject(a),d.setErrors("Could not delete user.",a.data.errors),s(!1)}),e.promise},this.deleteAll=function(){return s(!0),e=b.defer(),a["delete"](j).then(function(a){e.resolve(a.data),s(!1)},function(a){e.reject(a),d.setErrors("Could not delete users.",a.data.errors),s(!1)}),e.promise};var o=function(a){return a.id<=0&&(a.id=null),a.firstName=a.firstName.trim(),a.lastName=a.lastName.trim(),a};this.getUsersListLoadedStatus=function(){return k},this.getLoadingStatus=function(){return l},this.getSavingStatus=function(){return m},this.getDeletionStatus=function(){return n};var p=function(a){k=a},q=function(a){l=a},r=function(a){m=a},s=function(a){n=a}}]);